# Package dependencies (uncomment if using cloud storage like S3/GCS/Azure)
# spark.jars.packages                     org.apache.spark:spark-hadoop-cloud_2.12:3.5.0

# Spark master URL
spark.master                            spark://spark-1:7077

# Hive catalog integration
spark.sql.catalogImplementation         hive

# Event logging for history server
spark.eventLog.enabled                  true
spark.eventLog.dir                      /opt/spark/spark-events
spark.history.fs.logDirectory           /opt/spark/spark-events

# Data warehouse location (mounted volume for easy cleanup)
spark.sql.warehouse.dir                 /data/spark-warehouse

# Driver memory (runs on spark-1, separate from worker limits)
spark.driver.memory                     4g
spark.driver.cores                      2
spark.driver.maxResultSize              2g
spark.driver.memoryOverhead             512m

# Worker/Executor configuration (6 GB, 2 cores per worker, 3 executors)
# Note: memory + overhead must fit within container limits (8GB for spark-2/3)
spark.executor.instances                3
spark.executor.memory                   6g
spark.executor.cores                    2
spark.executor.memoryOverhead           512m

# Parallelism settings (matches bucket count)
spark.sql.shuffle.partitions            60
spark.default.parallelism               60

# Bucketing optimizations
spark.sql.sources.bucketing.enabled     true
spark.sql.autoBroadcastJoinThreshold    10MB

# Memory management - spill to disk when tight
spark.memory.fraction                   0.6
spark.memory.storageFraction            0.3

# Enable adaptive query execution for better resource usage
spark.sql.adaptive.enabled              false
# spark.sql.adaptive.coalescePartitions.enabled true
# spark.sql.adaptive.skewJoin.enabled     true

# Parquet compression (none/uncompressed/snappy/gzip/lzo/brotli/lz4/zstd)
spark.sql.parquet.compression.codec     uncompressed

# Disable Hadoop CRC checksum files (.crc files)
spark.hadoop.fs.file.impl               org.apache.hadoop.fs.RawLocalFileSystem
